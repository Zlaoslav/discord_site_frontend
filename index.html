<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PollPi Dashboard</title>

<link rel="icon" type="image/png" href="favicon.png">

<style>
:root {
  --bg:#0f1115;
  --card:#1a1d24;
  --text:#ffffff;
  --muted:#9aa0a6;
  --primary:#5865f2;
  --danger:#ed4245;
}
[data-theme="light"] {
  --bg:#f2f3f5;
  --card:#ffffff;
  --text:#000000;
  --muted:#555;
}
body{
  margin:0;
  font-family:Segoe UI, sans-serif;
  background:var(--bg);
  color:var(--text);
}
.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 24px;
  background:var(--card);
}
.brand{
  display:flex;
  align-items:center;
  gap:8px;
}
.brand img{
  width:28px;
  height:28px;
}
.bot-badge{
  background:var(--primary);
  color:white;
  font-size:11px;
  font-weight:700;
  padding:2px 6px;
  border-radius:4px;
}
.dashboard-label{
  font-size:13px;
  color:var(--muted);
}
.button{
  padding:6px 14px;
  border-radius:6px;
  border:none;
  cursor:pointer;
  font-weight:500;
}
.button-outline{
  background:transparent;
  border:1px solid var(--primary);
  color:var(--primary);
}
.button-primary{
  background:var(--primary);
  color:white;
}
.button-danger{
  background:var(--danger);
  color:white;
}
.container{
  padding:24px;
}
.card{
  background:var(--card);
  padding:16px;
  border-radius:10px;
  margin-bottom:16px;
}
input, select{
  width:100%;
  padding:6px;
  margin-top:4px;
  margin-bottom:12px;
  background:var(--bg);
  border:1px solid var(--muted);
  border-radius:6px;
  color:var(--text);
}
label{
  font-size:14px;
}
.hidden{display:none;}
.avatar{
  width:32px;
  height:32px;
  border-radius:50%;
}
.guild-card{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
</style>
</head>
<body>

<div id="app"></div>

<script>
const API_BASE = "http://localhost:3000";

let currentUser = null;
let currentGuild = null;

function getTheme(){
  return localStorage.getItem("theme") || "dark";
}
function setTheme(t){
  localStorage.setItem("theme",t);
}
document.documentElement.dataset.theme = getTheme();

function topBar(){
  const logged = !!currentUser;
  const themeIcon = getTheme()==="dark"?"üåô":"‚òÄÔ∏è";

  return `
  <div class="topbar">
    <div class="brand">
      <img src="favicon.png">
      <strong>PollPi</strong>
      <span class="bot-badge">–ë–û–¢</span>
      <span class="dashboard-label">Dashboard</span>
    </div>
    <div>
      ${logged ? `
        <img src="${currentUser.avatar}" class="avatar">
        ${currentUser.username}
        <button class="button button-danger" onclick="logout()">–í—ã–π—Ç–∏</button>
      ` : `
        <button class="button button-outline" onclick="login()">–í–æ–π—Ç–∏</button>
      `}
      <button class="button" onclick="toggleTheme()">${themeIcon}</button>
    </div>
  </div>
  `;
}

function toggleTheme(){
  const next = getTheme()==="dark"?"light":"dark";
  setTheme(next);
  document.documentElement.dataset.theme = next;
  render();
}

function login(){
  window.location.href = API_BASE + "/login";
}

function logout(){
  currentUser=null;
  render();
}

function renderGuilds(){
  return `
  <div class="container">
    <h2>–í–∞—à–∏ —Å–µ—Ä–≤–µ—Ä—ã</h2>
    <div class="card guild-card">
      <div>Test Guild</div>
      ${currentUser?.isAdmin ? `
        ${currentUser.botInGuild ?
          `<button class="button button-primary" onclick="openGuild()">–û—Ç–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å</button>`
          :
          `<button class="button button-primary">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å</button>`
        }
      `:`<span>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞</span>`}
    </div>
  </div>`;
}

function openGuild(){
  if(!currentUser?.isAdmin){
    render();
    return;
  }
  if(!currentUser.botInGuild){
    render();
    return;
  }
  currentGuild="Test Guild";
  renderGuildPanel();
}

function renderGuildPanel(){
  document.getElementById("app").innerHTML = topBar() + `
  <div class="container">
    <h2>${currentGuild}</h2>

    <div class="card">
      <h3>–ú–æ–¥–µ—Ä–∞—Ü–∏—è</h3>
      <label>–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</label>
      <input type="text">

      <label>–ú–∞–∫—Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π</label>
      <input type="number">

      <label>–í–∫–ª—é—á–∏—Ç—å –∞–Ω—Ç–∏-—Å–ø–∞–º</label>
      <select>
        <option>true</option>
        <option>false</option>
      </select>
    </div>

    <div class="card">
      <h3>–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</h3>
      <label>–í–∫–ª—é—á–∏—Ç—å –∏–≥—Ä—ã</label>
      <select>
        <option>true</option>
        <option>false</option>
      </select>

      <label>–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–Ω–ª–∞–π–Ω –¥–ª—è –∏–≥—Ä</label>
      <input type="number">
    </div>

    <div class="card">
      <h3>–†–æ–ª–∏</h3>
      <label>–í—ã–±–æ—Ä —Ä–æ–ª–∏</label>
      <select>
        <option>Admin</option>
        <option>Moderator</option>
        <option>Member</option>
      </select>

      <label>–í—ã–±–æ—Ä —É—á–∞—Å—Ç–Ω–∏–∫–∞</label>
      <select>
        <option>User1</option>
        <option>User2</option>
      </select>
    </div>

    <button class="button button-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
  </div>
  `;
}

function render(){
  document.getElementById("app").innerHTML = topBar() + renderGuilds();
}

/* –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ */
currentUser = {
  username:"AdminUser",
  avatar:"https://cdn.discordapp.com/embed/avatars/0.png",
  isAdmin:true,
  botInGuild:true
};

render();
</script>

</body>
</html>
